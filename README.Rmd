---
output: github_document
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# mregions2

<!-- badges: start -->
<!-- badges: end -->

mregions2 allows to access the [Marine Regions Gazetteer](https://marineregions.org/gazetteer.php) and the [Marine Regions Data Products](https://marineregions.org/sources.php) in R.

You can find detailed information in the vignettes:
* Introduction to mregions2: `vignette("mregions2")`
* Why mregions and mregions2?: `vignette("why_mregions2")`
* mregions2 as RDF: `vignette("mregions2-rdf")`


## Installation

You can install the development version of mregions2 from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("lifewatch/mregions2")
```

# Search the Marine Regions Gazetteer

The [Marine Regions Gazetteer](https://marineregions.org/gazetteer.php) is a standard list of marine georeferenced place names.

> Gazetteer: a dictionary of geographical names. 

<sup>https://www.thefreedictionary.com/gazetteer</sup>

You can look up for marine places the Marine Regions Gazetteer with a free text search:

```{r gaz1}
require(mregions2)

gaz_search("Belgian")
```
You can also make a fuzzy search or restrict to names in a certain language: 

```{r gaz5}
# Make a fuzzy search to find Belgium in the Dutch language.
# Note the term Belgie is mispelled: it should be BelgiÃ«. This is ignored thanks to the fuzzy search.

gaz_search("Belgie", language = "nl", fuzzy = TRUE)
```

## Search by MRGID

The entries in the Marine Regions Gazetteer are identified with an unique and persistent identifier: the Marine Regions Global Identifier or MRGID. The concept of MRGID is further explained in `vignette("mregions2")`.

You can pass this identifier to `gaz_search()` to get only that record. E.g. in the previous example, the Belgian Exclusive Economic Zone has the MRGID 3293:

```{r gaz2}
gaz_search(3293)
```

## Include geometries

To avoid overloading the server, the geometry of the record is not returned by default. You can pass the result of `gaz_search()` to `gaz_geometry()` if you want to also get the geometry of the record. It will return an object of class `sf::sf`. 

```{r gaz3}
require(magrittr)

gaz_search(3293) %>% gaz_geometry()
```

You can also use the argument `with_geometry` as `gaz_search(3293, with_geometry = TRUE)` to load the geometry directly

Several MRGIDs can be returned in one call:

```{r gaz4}
gaz_search(c(14, 3293))
```

## Reverse Geocode: Search by longitude-latitude

You can do a reverse geocode with mregions2: passing a pair longitude-latitude coordinates in WGS84 will return all records that intersect with the point.

e.g. the pair [longitude 2.927 - latitude 51.21551](https://www.openstreetmap.org/search?query=51.21551%252C%202.927) lays on the city of [Ostend](https://wikipedia.org/wiki/Ostend) at the Belgian coast 

```{r gaz6}
gaz_search(x = 2.927, y = 51.21551)
```

Passing an `sf::sfg` geometry object is also allowed:

```{r gaz7}
require(sf)

pt <- st_point(c(x = 2.927, y = 51.21551))
pt

gaz_search(pt)
```

## Search by place type

The records of the Marine Regions Gazetteer have a place types assigned, either physical such as sea mounts or banks, or administrative like Territorial Sea or Exclusive Economic Zone. 

You can find the full list, descriptions and its identifier in the database with [gaz_types()]:

```{r gaz8}
gaz_types()
```

You can restrict your search to a certain typeid:

```{r gaz9}
gaz_search("Oostende", typeid = 1)
```

Or you can look up all the records with a certain place type, either passed as text or with the typeid
```{r gaz10}
gaz_search_by_type("EEZ")
```

```{r gaz11}
gaz_search_by_type(c(350, 351))
```
